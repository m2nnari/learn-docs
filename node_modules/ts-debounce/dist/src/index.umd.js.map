{"version":3,"file":"index.umd.js","sources":["../../src/index.ts"],"sourcesContent":["/**\n * A function that emits a side effect and does not return anything.\n */\nexport type Procedure = (...args: any[]) => void;\n\nexport type Options = {\n  isImmediate?: boolean;\n  maxWait?: number;\n};\n\nexport interface DebouncedFunction<F extends Procedure> {\n  (this: ThisParameterType<F>, ...args: Parameters<F>): void;\n  cancel: () => void;\n}\n\nexport function debounce<F extends Procedure>(\n  func: F,\n  waitMilliseconds = 50,\n  options: Options = {}\n): DebouncedFunction<F> {\n  let timeoutId: ReturnType<typeof setTimeout> | undefined;\n  const isImmediate = options.isImmediate ?? false;\n  const maxWait = options.maxWait;\n  let lastInvokeTime = Date.now();\n\n  function nextInvokeTimeout() {\n    if (maxWait !== undefined) {\n      const timeSinceLastInvocation = Date.now() - lastInvokeTime;\n\n      if (timeSinceLastInvocation + waitMilliseconds >= maxWait) {\n        return maxWait - timeSinceLastInvocation;\n      }\n    }\n\n    return waitMilliseconds;\n  }\n\n  const debouncedFunction = function (\n    this: ThisParameterType<F>,\n    ...args: Parameters<F>\n  ) {\n    const context = this;\n\n    const invokeFunction = function () {\n      timeoutId = undefined;\n      lastInvokeTime = Date.now();\n      if (!isImmediate) {\n        func.apply(context, args);\n      }\n    };\n\n    const shouldCallNow = isImmediate && timeoutId === undefined;\n\n    if (timeoutId !== undefined) {\n      clearTimeout(timeoutId);\n    }\n\n    timeoutId = setTimeout(invokeFunction, nextInvokeTimeout());\n\n    if (shouldCallNow) {\n      func.apply(context, args);\n    }\n  };\n\n  debouncedFunction.cancel = function () {\n    if (timeoutId !== undefined) {\n      clearTimeout(timeoutId);\n    }\n  };\n\n  return debouncedFunction;\n}\n"],"names":["func","waitMilliseconds","options","timeoutId","isImmediate","maxWait","lastInvokeTime","Date","now","nextInvokeTimeout","undefined","timeSinceLastInvocation","debouncedFunction","args","context","this","invokeFunction","apply","shouldCallNow","clearTimeout","setTimeout","cancel"],"mappings":"8MAgBEA,EACAC,EACAC,SAEIC,WAHJF,IAAAA,EAAmB,aACnBC,IAAAA,EAAmB,IAGnB,IAAME,WAAcF,EAAQE,gBACtBC,EAAUH,EAAQG,QACpBC,EAAiBC,KAAKC,MAE1B,SAASC,IACP,QAAgBC,IAAZL,EAAuB,CACzB,IAAMM,EAA0BJ,KAAKC,MAAQF,EAE7C,GAAIK,EAA0BV,GAAoBI,EAChD,OAAOA,EAAUM,EAIrB,OAAOV,EAGT,IAAMW,EAAoB,eAErBC,2BAEGC,EAAUC,KAEVC,EAAiB,WACrBb,OAAYO,EACZJ,EAAiBC,KAAKC,MACjBJ,GACHJ,EAAKiB,MAAMH,EAASD,IAIlBK,EAAgBd,QAA6BM,IAAdP,OAEnBO,IAAdP,GACFgB,aAAahB,GAGfA,EAAYiB,WAAWJ,EAAgBP,KAEnCS,GACFlB,EAAKiB,MAAMH,EAASD,IAUxB,OANAD,EAAkBS,OAAS,gBACPX,IAAdP,GACFgB,aAAahB,IAIVS"}